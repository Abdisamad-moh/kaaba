{% extends 'admin_base2.html.twig' %}
{% import 'macros/_form_macros.html.twig' as macros %}

{% block title %}
Metier Orders
{% endblock %}

{% block body %}
<div class="">
	<!-- Modern Header with Button -->
	<div class="card custom-header shadow-sm mb-4">
		<div class="card-body p-4">
			<div class="d-flex justify-content-between align-items-center">
				<div>
					<h4 class="fw-semibold mb-0 text-white">
						<i class="ti ti-shopping-cart fs-4 me-2"></i>
						Metier Orders
					</h4>
					<p class="mb-0 text-white-50">Manage Metier orders efficiently.</p>
				</div>
				<div class="d-flex gap-2">
					<!-- <a href="#" class="btn btn-light btn-lg text-primary fw-semibold">
																																																								                            <i class="ti ti-plus me-2"></i>
																																																								                            Create Order
												</a> -->
												<div class="btn-group" role="group">
													<button id="btnGroupDrop1" type="button" class="btn btn-md bg-white dropdown-toggle rounded fw-semibold"
														data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="color: #51006A;">
														Add Subscription
													</button>
													<div class="dropdown-menu btn btn-lg text-primary rounded" aria-labelledby="btnGroupDrop1">
														<a class="dropdown-item text-white" href="{{ path('app_admin_add_order', { type: 'jobseeker' }) }}"
															style="background-color: #2e2e2e;">
															For Jobseeker
														</a>
														<a class="dropdown-item text-white" href="{{ path('app_admin_add_order', { type: 'employer' }) }}"
															style="background-color: #2e2e2e;">
															For Employer
														</a>
														</div>
														</div>
							</div>
							</div>
							</div>
							</div>

	<!-- Search Form -->
	<div class="row">
		<div class="col-12">
			{{ macros.render_search_form(searchForm, 'Filter') }}
		</div>
	</div>

	<!-- Data Table Section -->
	<div class="card custom-card shadow-sm">
		<div class="card-body p-4">
			<div class="table-responsive">
				<table id="accounts" class="table table-striped table-hover w-100">
					<thead class="custom-table-header">
						<tr>
							<th>Order ID</th>
							<th>Customer</th>
							<th>Amount</th>
							<th>Item</th>
							<th>Status</th>
							<th>Category</th>
							<th>Type</th>
							<th>Order Date</th>
							<th>Valid From</th>
							<th>Valid To</th>
							<th>Actions</th>
							</tr>
							</thead>
							<tbody>
								{% for order in orders %}
								<tr>
									<td>{{ loop.index }}</td>
									<td>{{ order.customer.name }}</td>
									<td>{{ order.amount }}</td>
									<td>{{ order.plan.name| capitalize }}</td>
									<td>
								<span
									class="badge {% if order.paymentstatus == 'paid' %}bg-success{% elseif order.paymentstatus == 'pending' %}bg-warning{% else %}bg-danger{% endif %}">
									{{ order.paymentstatus | capitalize }}
								</span>
								</td>
								<td>{{ order.category }}</td>
								<td>{{ order.customerType|capitalize }}</td>

								<td>{{ order.orderDate|date('d-m-Y') }}</td>
								<td>{{ order.validFrom|date('d-m-Y') }}</td>
								<td>{{ order.validTo|date('d-m-Y') }}</td>
								<td>
	{% if order.plan.category == 'subscription' %}
		<div class="btn-group" role="group">
			<a href="{{ path('app_admin_add_order', { type: 'subscription', order: order.id }) }}"
				class="btn btn-outline-secondary btn-sm">
				<i class="ti ti-edit me-1"></i>
				Edit
			</a>
			<a href="{{ path('app_admin_cancel_plan', { plan: order.id }) }}" class="btn btn-outline-danger btn-sm">
				<i class="ti ti-trash me-1"></i>
				Cancel
				</a>
				</div>
	{% endif %}
</td>
</tr>
{% else %}
<tr>
	<td colspan="9" class="text-center">No orders found.</td>
</tr>
{% endfor %}
</tbody>
</table>
</div>

			<!-- Pagination -->
			<div class="navigation mt-4">
				{% do orders.setPageRange(2) %}
				{{ knp_pagination_render(orders, 'pagination.html.twig') }}
			</div>
			</div>
			</div>
			</div>
{% endblock %}